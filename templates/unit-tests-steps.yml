# File: templates/unit-tests-steps.yml
steps:
- bash: sudo apt-get install lcov
  condition: eq( variables['Agent.OS'], 'Linux' )
  displayName: 'install lcov for linux'
- bash: brew install lcov
  condition: eq( variables['Agent.OS'], 'Darwin' )
  displayName: 'install lcov for osx'
- script: git clone https://github.com/siu/minunit lib
  displayName: 'clone minunit test lib'
- script: make lym
  displayName: 'Building lym executable'
- script: make tests
  displayName: 'Launching unit test'
- script: sh cover.sh
  condition: eq( variables['Agent.OS'], 'Darwin' )
  displayName: 'run the coverage build process'
- script: bash <(curl -s https://codecov.io/bash)
  condition: eq( variables['Agent.OS'], 'Darwin' )
  displayName: 'Upload codecoverage'
